package se.llbit.chunky.renderer.scene.atmosphere.aerosol;

import se.llbit.chunky.renderer.scene.atmosphere.Util;

public final class UrbanAerosol extends Aerosol {
  private static final double[][] ABSORPTION_CROSS_SECTION = new double[][] {
      {360.0, 4.7028e-22},
      {370.0, 4.2239e-22},
      {380.0, 3.8031e-22},
      {390.0, 3.4321e-22},
      {400.0, 3.1047e-22},
      {410.0, 2.8146e-22},
      {420.0, 2.5573e-22},
      {430.0, 2.3284e-22},
      {440.0, 2.1240e-22},
      {450.0, 1.9415e-22},
      {460.0, 1.7778e-22},
      {470.0, 1.6309e-22},
      {480.0, 1.4988e-22},
      {490.0, 1.3798e-22},
      {500.0, 1.2723e-22},
      {510.0, 1.1750e-22},
      {520.0, 1.0866e-22},
      {530.0, 1.0063e-22},
      {540.0, 9.3336e-23},
      {550.0, 8.6685e-23},
      {560.0, 8.0627e-23},
      {570.0, 7.5084e-23},
      {580.0, 7.0015e-23},
      {590.0, 6.5363e-23},
      {600.0, 6.1093e-23},
      {610.0, 5.7175e-23},
      {620.0, 5.3565e-23},
      {630.0, 5.0236e-23},
      {640.0, 4.7160e-23},
      {650.0, 4.4318e-23},
      {660.0, 4.1679e-23},
      {670.0, 3.9233e-23},
      {680.0, 3.6966e-23},
      {690.0, 3.4860e-23},
      {700.0, 3.2900e-23},
      {710.0, 3.1085e-23},
      {720.0, 2.9395e-23},
      {730.0, 2.7817e-23},
      {740.0, 2.6344e-23},
      {750.0, 2.4966e-23},
      {760.0, 2.3580e-23},
      {770.0, 2.2292e-23},
      {780.0, 2.1097e-23},
      {790.0, 1.9986e-23},
      {800.0, 1.8952e-23},
      {810.0, 1.8028e-23},
      {820.0, 1.7160e-23},
      {830.0, 1.6343e-23},
  };

  private static final double[][] SCATTERING_CROSS_SECTION = new double[][] {
      {360.0, 3.5222e-22},
      {370.0, 3.3707e-22},
      {380.0, 3.2286e-22},
      {390.0, 3.0950e-22},
      {400.0, 2.9696e-22},
      {410.0, 2.8907e-22},
      {420.0, 2.8165e-22},
      {430.0, 2.7462e-22},
      {440.0, 2.6797e-22},
      {450.0, 2.6190e-22},
      {460.0, 2.6767e-22},
      {470.0, 2.7332e-22},
      {480.0, 2.7866e-22},
      {490.0, 2.8373e-22},
      {500.0, 2.8848e-22},
      {510.0, 2.7923e-22},
      {520.0, 2.7037e-22},
      {530.0, 2.6191e-22},
      {540.0, 2.5384e-22},
      {550.0, 2.4643e-22},
      {560.0, 2.4849e-22},
      {570.0, 2.5075e-22},
      {580.0, 2.5292e-22},
      {590.0, 2.5501e-22},
      {600.0, 2.5701e-22},
      {610.0, 2.5808e-22},
      {620.0, 2.5910e-22},
      {630.0, 2.6009e-22},
      {640.0, 2.6106e-22},
      {650.0, 2.6197e-22},
      {660.0, 2.6150e-22},
      {670.0, 2.6103e-22},
      {680.0, 2.6059e-22},
      {690.0, 2.6018e-22},
      {700.0, 2.5983e-22},
      {710.0, 2.6262e-22},
      {720.0, 2.6537e-22},
      {730.0, 2.6804e-22},
      {740.0, 2.7064e-22},
      {750.0, 2.7346e-22},
      {760.0, 3.0342e-22},
      {770.0, 3.3285e-22},
      {780.0, 3.6152e-22},
      {790.0, 3.8948e-22},
      {800.0, 4.1622e-22},
      {810.0, 4.0891e-22},
      {820.0, 4.0134e-22},
      {830.0, 3.9398e-22},
  };

  public UrbanAerosol(double turbidity) {
    super(turbidity, 8.544e18, 2e6, 0.73);
  }

  @Override
  protected double getAbsorptionCrossSection(double wl) {
    return Util.lutLerp(ABSORPTION_CROSS_SECTION, wl);
  }

  @Override
  protected double getScatteringCrossSection(double wl) {
    return Util.lutLerp(SCATTERING_CROSS_SECTION, wl);
  }
}
