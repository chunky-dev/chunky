package se.llbit.chunky.renderer.scene.atmosphere.aerosol;

import se.llbit.chunky.renderer.scene.atmosphere.Util;

public final class MaritimeCleanAerosol extends Aerosol {
  private static final double[][] desertDustAbsorptionCrossSection = new double[][] {
      {360.0, 4.1273e-16},
      {370.0, 4.1287e-16},
      {380.0, 4.1298e-16},
      {390.0, 4.1312e-16},
      {400.0, 4.1345e-16},
      {410.0, 4.1373e-16},
      {420.0, 4.1380e-16},
      {430.0, 4.1492e-16},
      {440.0, 4.1562e-16},
      {450.0, 4.1699e-16},
      {460.0, 4.1868e-16},
      {470.0, 4.1810e-16},
      {480.0, 4.2080e-16},
      {490.0, 4.1986e-16},
      {500.0, 4.2291e-16},
      {510.0, 4.2402e-16},
      {520.0, 4.2776e-16},
      {530.0, 4.3358e-16},
      {540.0, 4.3448e-16},
      {550.0, 4.4695e-16},
      {560.0, 4.4645e-16},
      {570.0, 4.5019e-16},
      {580.0, 4.6188e-16},
      {590.0, 4.5954e-16},
      {600.0, 4.6552e-16},
      {610.0, 4.7575e-16},
      {620.0, 4.7034e-16},
      {630.0, 4.6794e-16},
      {640.0, 4.7937e-16},
      {650.0, 4.8121e-16},
      {660.0, 4.7506e-16},
      {670.0, 4.8124e-16},
      {680.0, 4.9612e-16},
      {690.0, 4.9827e-16},
      {700.0, 4.9147e-16},
      {710.0, 4.9394e-16},
      {720.0, 5.0729e-16},
      {730.0, 5.1219e-16},
      {740.0, 5.0358e-16},
      {750.0, 4.9739e-16},
      {760.0, 5.2279e-16},
      {770.0, 5.6035e-16},
      {780.0, 5.9223e-16},
      {790.0, 6.1249e-16},
      {800.0, 6.3642e-16},
      {810.0, 6.4141e-16},
      {820.0, 6.6077e-16},
      {830.0, 6.7588e-16},
  };

  private static final double[][] desertDustScatteringCrossSection = new double[][] {
      {360.0, 3.4215e-16},
      {370.0, 3.4240e-16},
      {380.0, 3.4266e-16},
      {390.0, 3.4288e-16},
      {400.0, 3.4308e-16},
      {410.0, 3.4320e-16},
      {420.0, 3.4319e-16},
      {430.0, 3.4296e-16},
      {440.0, 3.4234e-16},
      {450.0, 3.4110e-16},
      {460.0, 3.4069e-16},
      {470.0, 3.4022e-16},
      {480.0, 3.3966e-16},
      {490.0, 3.3900e-16},
      {500.0, 3.3824e-16},
      {510.0, 3.3598e-16},
      {520.0, 3.3303e-16},
      {530.0, 3.2921e-16},
      {540.0, 3.2435e-16},
      {550.0, 3.1835e-16},
      {560.0, 3.1454e-16},
      {570.0, 3.1042e-16},
      {580.0, 3.0589e-16},
      {590.0, 3.0092e-16},
      {600.0, 2.9559e-16},
      {610.0, 2.9413e-16},
      {620.0, 2.9275e-16},
      {630.0, 2.9137e-16},
      {640.0, 2.8999e-16},
      {650.0, 2.8859e-16},
      {660.0, 2.8490e-16},
      {670.0, 2.8105e-16},
      {680.0, 2.7707e-16},
      {690.0, 2.7296e-16},
      {700.0, 2.6875e-16},
      {710.0, 2.6727e-16},
      {720.0, 2.6584e-16},
      {730.0, 2.6441e-16},
      {740.0, 2.6301e-16},
      {750.0, 2.6143e-16},
      {760.0, 2.4192e-16},
      {770.0, 2.1835e-16},
      {780.0, 1.9026e-16},
      {790.0, 1.5663e-16},
      {800.0, 1.1720e-16},
      {810.0, 1.1560e-16},
      {820.0, 1.1457e-16},
      {830.0, 1.1362e-16},
  };

  public MaritimeCleanAerosol(double turbidity) {
    super(turbidity, 1.8662e18, 2e6, 2.0);
  }

  @Override
  protected double getAbsorptionCrossSection(double wl) {
    return Util.lutLerp(desertDustAbsorptionCrossSection, wl);
  }

  @Override
  protected double getScatteringCrossSection(double wl) {
    return Util.lutLerp(desertDustScatteringCrossSection, wl);
  }
}
